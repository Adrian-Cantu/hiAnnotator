## Basic tests ##

query <- GRanges("A", IRanges(c(1, 5, 20), width=1), 
                 strand=c("-","+","+"))
subject <- GRanges("A", IRanges(c(1,5,10,15), width=8:5),
                   strand=c("+", "+", "-", "-"))

res <- as.data.frame(nearest(query, subject, select="all", ignore.strand=TRUE))

expect_that(res,
            is_identical_to(structure(list(queryHits = c(1L, 2L, 2L, 3L), 
                                           subjectHits = c(1L, 1L, 2L, 4L)), 
                                      .Names = c("queryHits", "subjectHits"), 
                                      row.names = c(NA, -4L), class = "data.frame")))

